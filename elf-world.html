<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Emoji Zelda Game</title>

<style>
  * { box-sizing: border-box;}
    html, body {
      margin: 0;
      padding: 0;
      overflow: hidden;
    }

    body {
      font-size: 2rem;
      background: #333;
    }

    .view {
      width: 100vw;
      height: 100vh;
      overflow: hidden;
      position: relative;
    }

    .world {
      position: absolute;
      display: grid;
      grid-template-columns: repeat(30, 1fr);
      grid-template-rows: repeat(20, 1fr);
      width: 3000px; /* 100px * 30 cols */
      height: 2000px; /* 100px * 20 rows */
      transition: transform 0.1s ease-out;
    }

    .tile {
      width: 100px;
      height: 100px;
      display: flex;
      border: 1px solid whitesmoke;
      align-items: center;
      justify-content: center;
    }

    .player {
      position: absolute;
      width: 100px;
      height: 100px;
      z-index: 2;
      pointer-events: none;
    }
  
</style>
</head>
<body>

<div class="view">
  <div class="world" id="world"></div>
  <div class="player" id="player">üßù‚Äç‚ôÇÔ∏è</div>
</div>

<script>
  const COLS = 30
  const ROWS = 20
  const TILE_SIZE = 100
  const VIEW_WIDTH = 10
  const VIEW_HEIGHT = 8

  const worldEl = document.getElementById('world')
  const playerEl = document.getElementById('player')

  // Create tiles
  const tiles = []
  for (let y = 0; y < ROWS; y++) {
    for (let x = 0; x < COLS; x++) {
      const tile = document.createElement('div')
      tile.className = 'tile'
      tile.dataset.x = x
      tile.dataset.y = y
      tile.textContent = Math.random() < 0.1 ? 'üå≤' : ''
      worldEl.appendChild(tile)
      tiles.push(tile)
    }
  }

  let px = 15
  let py = 10
  let cameraX = px
  let cameraY = py

  function clamp(val, min, max) {
    return Math.max(min, Math.min(max, val))
  }

  function updatePlayerPosition() {
    playerEl.style.left = `${px * TILE_SIZE}px`
    playerEl.style.top = `${py * TILE_SIZE}px`
  }

  function updateCamera() {
    const marginX = Math.floor(VIEW_WIDTH / 2)
    const marginY = Math.floor(VIEW_HEIGHT / 2)

    const leftEdge = cameraX - marginX
    const topEdge = cameraY - marginY

    const maxCameraX = COLS - VIEW_WIDTH
    const maxCameraY = ROWS - VIEW_HEIGHT

    // If player moves near edge of view, move camera
    if (px < cameraX - marginX + 1) cameraX = clamp(px + marginX - 1, marginX, COLS - marginX - 1)
    if (px > cameraX + marginX - 1) cameraX = clamp(px - marginX + 1, marginX, COLS - marginX - 1)
    if (py < cameraY - marginY + 1) cameraY = clamp(py + marginY - 1, marginY, ROWS - marginY - 1)
    if (py > cameraY + marginY - 1) cameraY = clamp(py - marginY + 1, marginY, ROWS - marginY - 1)

    const offsetX = clamp(cameraX - marginX, 0, COLS - VIEW_WIDTH) * TILE_SIZE
    const offsetY = clamp(cameraY - marginY, 0, ROWS - VIEW_HEIGHT) * TILE_SIZE

    worldEl.style.transform = `translate(${-offsetX}px, ${-offsetY}px)`
    playerEl.style.transform = `translate(${-offsetX}px, ${-offsetY}px)`
  }

  function move(dx, dy) {
    px = clamp(px + dx, 0, COLS - 1)
    py = clamp(py + dy, 0, ROWS - 1)
    updatePlayerPosition()
    updateCamera()
  }

  updatePlayerPosition()
  updateCamera()

  window.addEventListener('keydown', (e) => {
    if (e.key === 'ArrowLeft') move(-1, 0)
    else if (e.key === 'ArrowRight') move(1, 0)
    else if (e.key === 'ArrowUp') move(0, -1)
    else if (e.key === 'ArrowDown') move(0, 1)
  })
</script>

</body>
</html>
